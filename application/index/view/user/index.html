{{extend name="public:base" /}}
<!--标题-->
{{block name="title"}}
个人资料
{{/block}}

<!--主体-->
{{block name="main"}}
<!-- 内容墙,包含顶部面板 -->
<div class="content-wrapper">
	<section class="content">
		<div class="row">
			<div class="col-md-2">
			
			</div>
			<div class="col-md-8">
				<div class="box box-primary">
					<div class="box-body box-profile">
						<img class="profile-user-img img-responsive img-circle" src="__STATIC__/dist/img/jason.jpg" alt="User profile picture">
						
						<h3 class="profile-username text-center">Jaosn</h3>
						
						<p class="text-muted text-center">PHP开发工程师</p>
					
					</div>
					<div class="box-header with-border">
						<h3 class="box-title">关于我</h3>
					</div>
					<div class="box-body">
						<strong><i class="fa fa-book margin-r-5"></i> 教育水平</strong>
						
						<p class="text-muted">
							麻绳理工学院优秀毕业生
						</p>
						
						<hr>
						
						<strong><i class="fa fa-map-marker margin-r-5"></i> 工作地点</strong>
						
						<p class="text-muted">中国-广州</p>
						
						<hr>
						
						<strong><i class="fa fa-pencil margin-r-5"></i> 技能</strong>
						
						<p>
							<span class="label label-danger">UI设计</span> <span class="label label-success">编程</span> <span class="label label-info">Javascript</span> <span class="label label-warning">PHP</span> <span class="label label-primary">Node.js</span>
						</p>
						
						<hr>
						
						<strong><i class="fa fa-file-text-o margin-r-5"></i> 个性签名</strong>
						
						<p>背别人的锅,让别人无锅可背!</p>
					</div>
					<!-- /.box-body -->
				</div>
			</div>
			
			<div class="col-md-2">
			
			</div>
		</div>
	</section>
</div>
{{/block}}

{{block name="js"}}
<script type="text/javascript">
    $(document).ready(function () {
        DeviceList.addDevice();
    });
    let DeviceList = {
        /**
         * 异步添加设备
         * 当前模态框
         */
        addDevice: function () {
            $('#add_device_btn').on('click', function () {
                // TODO 表单验证
                $.ajax({
                    url: "{{:url('addDevice')}}",
                    data: $('#add_device_form').serializeArray(),
                    type: 'post',
                    dataType: 'json',
                    success: function (info) {
                        if (info.flag === true) {
                            $('#add-device').modal('hide');
                            swal("操作成功！", info.msg, "success").then(function () {
                                location.reload();
                            });
                        } else {
                            swal("WTF,失败了?!!", info.msg, "error");
                        }
                    },
                    error: function () {
                        swal("哎呀", "失败了失败了", "error");
                    }
                });
            })
        },
        /**
         * 显示发送命令模态框
         * @param _obj
         * 当前模态框
         */
        showOrderModal: function (_obj) {
            $('#send-order').modal('show');
            // 找到当前设备id
            let device_id = _obj.closest('tr').find('input[name="device_id"]').val();
            $('#device_id').val('');
            $('#device_id').val(device_id);
        },
        /**
         * 异步发送命令
         * @param _obj
         * 当前模态框
         */
        sendOrder: function (_obj) {
            let $device_id = $('#device_id').val();
            let $order_text = _obj.closest('form').find('[name="order_text"]').val();
            let data = `device_id=${$device_id}&order_text=${$order_text}`;
            $.ajax({
                url: "{{:url('sendOrder')}}",
                data: data,
                type: 'get',
                success: function (info) {
                    if (info.flag === true) {
                        $('#send-order').modal('hide');
                        swal("发送成功！", info.msg, "success").then(function () {

                        });
                    } else {
                        swal("WTF,失败了?!!", info.msg, "error");
                    }
                },
                error: function () {
                    swal("哎呀", "发送失败了失败了", "error");
                }
            });
        }
    }
</script>

{{/block}}

